# Flee Visualization
Based and built upon 
[Flee - the agent based modelling toolkit](https://github.com/djgroen/flee-release "Flee release link").
The simulated data from the flee system is exported into a json format and then
used to built several different visualizations using [Leaflet](https://leafletjs.com/).

![Preview Image](http://i.imgur.com/vxD1N40.gif)
## How to run
- clone / download the repository
- `cd` into the `visualization` directory and use `npm install`
- start the webserver from inside the `visualization` folder using `node app.js`
- navigate your web browser to `localhost:3000`

## How to generate the data
The data used by the visualization is generated by running any of 
the existing simulations. If you want to build a costum visulization from 
a new simulation check `general_vis.py` for an example.

### Steps for costum simulations
Import `visualization/vis.py`. Then inside your simulation code (python):
- Initialize visualization data generator
``` python
visoutput = visualization.vis.VisManager(flee.SimulationSettings.SimulationSettings.DefaultVisPath / "general.json")
start_date = datetime(2009, 12, 24)
current_date = datetime(2009, 12, 24)
  ```
- each time step, generate location and link data for every location
``` python
e.evolve()
# Visualization
assert t == visoutput.addTimeStep(current_date.strftime("%Y-%m-%d")) # how the timestep should be displayed
visoutput.addLocationDataAtTime(t, e.locations)
current_date = current_date + timedelta(days=1) # you can choose how your timestep increases (+1 hour instead 1 day f.e.)
# Visualization end
```
- after the simulation is finished, set the meta data and generate the 
visualization data using:
``` python
#                      Center for Map,       How to format the timestep,      Visulization Name, Visualization Description
visoutput.setMetaData([48.208176,16.373819], start_date.strftime("%Y-%m-%d"), "General", "General visualization")
visoutput.saveVisData()
```
## Config options
`config.js` is used to define some settings for the server
```javascript
exports.port = 3000; // port used
exports.dataDirectory = "/public/assets/data/"; // directory containing the visualization data
exports.debug = true; // turns debug prints on or off
```